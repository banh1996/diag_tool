<!DOCTYPE html> 
<html lang="en" xmlns:th="http://www.thymeleaf.com">
	<head>
		<title>UDS-Tool</title>
		<meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0">
    <link rel="stylesheet" href="style.css" />
	  <link rel="stylesheet" href="font-awesome.min.css" />
  </head>
	<body>
		<div class="page">
			<h1>UDS-Tool</h1>
			<!-- tabs -->
			<div class="pcss3t pcss3t-effect-scale pcss3t-theme-1">
				<input type="radio" name="pcss3t" checked  id="tab1"class="tab-content-first">
				<label for="tab1"><i class="icon-bolt"></i>Basic</label>

				<input type="radio" name="pcss3t" id="tab2" class="tab-content-2">
				<label for="tab2"><i class="icon-picture"></i>Advance</label>

				<input type="radio" name="pcss3t" id="tab3" class="tab-content-3">
				<label for="tab3"><i class="icon-cogs"></i>Config</label>

				<input type="radio" name="pcss3t" id="tab5" class="tab-content-last">
				<label for="tab5"><i class="icon-globe"></i>Info</label>

				<ul>
					<li class="tab-content tab-content-first typography">
            <h2>Basic commands</h2>
            <div style="display: inline-block;">
              <input id="ipaddress-txt" placeholder="IP:PORT" />
              <button id="connect-btn" state="disconnected">CONNECT</button>
              <input id="activation-txt" placeholder="0">
              <span style="float: right;">Activation code:</span>
            </div>
            <div style="display: inline-block;">
              <input id="diag-cmd" placeholder="type message for diag" />
              <button id="senduds-btn">send uds</button>
              <button id="senddoip-btn">send doip</button>
              <input id="doip-cmd" placeholder="type message for doip" />
              <div id="log-box" placeholder="view message log here">
              </div>
            </div>
            <div id="response"></div>
            <script>
              const ipaddressInput = document.querySelector('#ipaddress-txt')
              const connectBtn = document.querySelector('#connect-btn')
              const sendudsBtn = document.querySelector('#senduds-btn')
              const diagInput = document.querySelector('#diag-cmd')
              const senddoipBtn = document.querySelector('#senddoip-btn')
              const doipInput = document.querySelector('#doip-cmd')
              const logBox = document.querySelector("#log-box");
              logBox.style.width = "100%";
              logBox.style.height = "300px";
              logBox.style.border = "1px solid black";
              logBox.style.overflowY = "auto";

              function updateResponse(response) {
                logBox.append( typeof response === 'string' ? response : JSON.stringify(response))
              }

              connectBtn.addEventListener('click', () => {
                connectBtn.setAttribute("state", "connected");
                window.__TAURI__
                  .invoke('connect')
                  .then(updateResponse)
                  .catch(updateResponse)
              })

              sendudsBtn.addEventListener('click', () => {
                window.__TAURI__
                  .invoke('senduds', {
                    value: diagInput.value
                  })
                  .then(updateResponse)
                  .catch(updateResponse)
              })

              senddoipBtn.addEventListener('click', () => {
                window.__TAURI__
                  .invoke('senddoip', {
                    value: doipInput.value
                  })
                  .then(updateResponse)
                  .catch(updateResponse)
              })
            </script>
					</li>

					<li class="tab-content tab-content-2 typography">
						<h3>SWDL</h3>
            <input type="file" id="fileswdl-button" title="files"></input>
            <button id="flash-btn">flash</button>
            <h3>Sequence</h3>
            <input type="file" id="sequence-button" title="files"></input>
            <button id="execute-btn">execute</button>
            <h3>Security-Access</h3>
            <input id="SAlevel" width="30px" placeholder="SA-level" />
            <input id="SAkey" placeholder="type security-access key" />
            <button id="sendSA-btn">send</button>
						<script>
              const fileswdlButton = document.querySelector("#fileswdl-button");
              fileswdlButton.addEventListener("change", () => {
                window.__TAURI__
                  .invoke('parse', {
                    input: fileswdlButton.files[0].path
                  })
                  .then(updateResponse)
                  .catch(updateResponse)
              });
            </script>
					</li>

					<li class="tab-content tab-content-3 typography">
						<h3>ECU parameters</h3>
						<div>
              <input id="ECUaddr" placeholder="ECU-addr (doip)" />
            </div>
            <div>
              <input id="Testeraddr" placeholder="Tester-addr (doip)" />
            </div>
            <div>
              <input id="doipversion" placeholder="version (doip)" />
            </div>
            <select class="vendor-select" id="vendor">
              <option value="common">üîµ common</option>
              <option value="volvo">‚ö™ Volvo</option>
              <option value="vinfast">‚ö´ Vinfast</option>
              <!-- <option value="purple">üü£ Purple</option>
              <option value="orange">üü† Orange</option>
              <option value="red">üî¥ Red</option>
              <option value="green">üü¢ Green</option>
              <option value="yellow">üü° Yellow</option>
              <option value="brown">üü§ Brown</option> -->
            </select>
					</li>

					<li class="tab-content tab-content-last typography">
						<div class="typography">
							<p>Author: Tr·∫ßn Ng·ªçc H√πng</p>
							<p>Embedded Engineer</p>
							<p>Nothing special, work for fun.</p>
						  <p class="text-right"><em>Check another projects at my github <a href="https://github.com/banh1996" target="_blank">banh1996</a>.</em></p>		
						</div>
					</li>
				</ul>
			</div>
			<!--/ tabs -->
		</div>
	</body>
</html>